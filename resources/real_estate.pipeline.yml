# The main pipeline for real_estate

resources:
  pipelines:
    real_estate_pipeline:
      name: real_estate_pipeline
      catalog: ${var.catalog}
      schema: ${var.schema}
      clusters:
        - label: default
          autoscale:
            min_workers: 1
            max_workers: 2
          node_type_id: n2-highmem-2
          gcp_attributes:
            availability: PREEMPTIBLE_GCP
            zone_id: HA
            google_service_account: databricks-gcs-reader@real-estate-valuation-463410.iam.gserviceaccount.com

      libraries:
        - notebook:
            path: ../src/pipeline/bronze/main.ipynb
        - notebook:
            path: ../src/pipeline/silver/main.ipynb
        - notebook:
            path: ../src/pipeline/gold/main.ipynb

      configuration:
        spark.databricks.bundle.variables.data_bucket: ${var.data_bucket}
        spark.databricks.bundle.variables.gcs_prefix: ${var.gcs_prefix}
        spark.databricks.bundle.variables.catalog: ${var.catalog}
        spark.databricks.bundle.variables.schema: ${var.schema}
        spark.databricks.bundle.mode: ${var.mode}
        PYTHONPATH: ${workspace.file_path}/src



